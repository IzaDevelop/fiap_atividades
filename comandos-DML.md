# Criação das tabelas Gulliver
CREATE TABLE TB_MUNICIPIO (
 CD_MUNICIPIO  NUMBER(10) NOT NULL,
 DS_MUNICIPIO  VARCHAR2(200),
 CONSTRAINT TB_MUNICIPIO_PK PRIMARY KEY ( CD_MUNICIPIO )
);
CREATE TABLE TB_TIPO_LOGRADOURO (
 CD_TIPO  NUMBER NOT NULL,
 DS_TIPO  VARCHAR2(100),
 CONSTRAINT TB_TIPO_LOGRADOURO_PK PRIMARY KEY ( CD_TIPO )
);
CREATE TABLE TB_BAIRRO (
 CD_BAIRRO NUMBER(10) NOT NULL,
 DS_BAIRRO VARCHAR2(100),
 CD_MUNICIPIO NUMBER(10) NOT NULL,
 CONSTRAINT TB_BAIRRO_PK PRIMARY KEY ( CD_BAIRRO ),
 CONSTRAINT TB_BAIRRO_TB_MUNICIPIO_FK FOREIGN KEY ( CD_MUNICIPIO )
 REFERENCES TB_MUNICIPIO ( CD_MUNICIPIO )
);
CREATE TABLE TB_ENDERECO (
 CD_ENDERECO NUMBER NOT NULL,
 CD_TIPO_LOGRADOURO NUMBER NOT NULL,
 DS_LOGRADOURO VARCHAR2(200),
 NU_COMPLEMENTO NUMBER,
 DS_COMPLEMENTO VARCHAR2(50),
 NU_CEP NUMBER,
 CD_BAIRRO NUMBER(10) NOT NULL,
 CONSTRAINT TB_ENDERECO_PK PRIMARY KEY ( CD_ENDERECO ),
 CONSTRAINT TB_ENDERECO_TB_BAIRRO_FK FOREIGN KEY ( CD_BAIRRO )
 REFERENCES TB_BAIRRO ( CD_BAIRRO ),
 CONSTRAINT TB_ENDERECO_TB_TIPO_LOGRADOURO_FK FOREIGN KEY ( CD_TIPO_LOGRADOURO )
 REFERENCES TB_TIPO_LOGRADOURO ( CD_TIPO )
);
CREATE TABLE TB_PONTO_TURISTICO (
 CD_PONTO_TURISTICO NUMBER NOT NULL,
 DS_PONTO_TURISTICO VARCHAR2(200),
 DS_TIPO VARCHAR2(50),
 CD_ENDERECO  NUMBER NOT NULL,
 CONSTRAINT TB_PONTO_TURISTICO_PK PRIMARY KEY ( CD_PONTO_TURISTICO ),
 CONSTRAINT TB_PONTO_TURISTICO_TB_ENDERECO_FK FOREIGN KEY ( CD_ENDERECO )
 REFERENCES TB_ENDERECO ( CD_ENDERECO )
);

# DML
## estrutura comando insert
INSERT INTO nome_tabela (nome_coluna_01, nome_coluna_02...)
VALUES (valor_coluna_01, valor_coluna_02...);

## insert
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (1, ‘São Paulo’);

## estrutura comando update
UPDATE nome_tabela
   SET nome_coluna = novo_conteúdo
 WHERE condicao;

## update
--CARREGA TB_MUNICIPIO
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (1, 'São Paulo');
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (2, 'Santos');
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (3, 'Guarujá');
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (4, 'Sano André');
INSERT INTO TB_MUNICIPIO (CD_MUNICIPIO, DS_MUNICIPIO)
VALUES (5, 'São Bernardo do Campo');
--CARREGA TB_BAIRRO
INSERT INTO TB_BAIRRO (CD_BAIRRO, DS_BAIRRO, CD_MUNICIPIO)
VALUES (1, 'Paraíso', 1);
INSERT INTO TB_BAIRRO (CD_BAIRRO, DS_BAIRRO, CD_MUNICIPIO)
VALUES (2, 'Liberdade', 1);
INSERT INTO TB_BAIRRO (CD_BAIRRO, DS_BAIRRO, CD_MUNICIPIO)
VALUES (3, 'Ibirapuera', 1);
INSERT INTO TB_BAIRRO (CD_BAIRRO, DS_BAIRRO, CD_MUNICIPIO)
VALUES (4, 'Vila Mariana', 1);
INSERT INTO TB_BAIRRO (CD_BAIRRO, DS_BAIRRO, CD_MUNICIPIO)
VALUES (5, 'Bela Vista', 1);
--CARREGA TB_TIPO_LOGRADOURO
INSERT INTO TB_TIPO_LOGRADOURO (CD_TIPO, DS_TIPO)
VALUES (1, 'Rua');
INSERT INTO TB_TIPO_LOGRADOURO (CD_TIPO, DS_TIPO)
VALUES (2, 'Avenida');
INSERT INTO TB_TIPO_LOGRADOURO (CD_TIPO, DS_TIPO)
VALUES (3, 'Travessa');
INSERT INTO TB_TIPO_LOGRADOURO (CD_TIPO, DS_TIPO)
VALUES (4, 'Alameda');
--CARREGA TB_ENDERECO
INSERT INTO TB_ENDERECO (CD_ENDERECO, CD_TIPO_LOGRADOURO, DS_LOGRADOURO, NU_COMPLEMENTO, DS_COMPLEMENTO, NU_CEP, CD_BAIRRO)
VALUES (1, 2, 'República do Líbano', 331, 'Portão 7', 04501000, 4);
INSERT INTO TB_ENDERECO (CD_ENDERECO, CD_TIPO_LOGRADOURO, DS_LOGRADOURO, NU_COMPLEMENTO, DS_COMPLEMENTO, NU_CEP, CD_BAIRRO)
VALUES (2, 2, 'Paulista', 1578, '', 01310200, 5);
INSERT INTO TB_ENDERECO (CD_ENDERECO, CD_TIPO_LOGRADOURO, DS_LOGRADOURO, NU_COMPLEMENTO, DS_COMPLEMENTO, NU_CEP, CD_BAIRRO)
VALUES (3, 1, 'Galvão Bueno', 72, '', 01506030, 2);
--CARREGA TB_PONTO_TURISTICO
INSERT INTO TB_PONTO_TURISTICO (CD_PONTO_TURISTICO, DS_PONTO_TURISTICO, DS_TIPO, CD_ENDERECO)
VALUES (1, 'Parque do Ibirapuera', 'Parque', 1);
INSERT INTO TB_PONTO_TURISTICO (CD_PONTO_TURISTICO, DS_PONTO_TURISTICO, DS_TIPO, CD_ENDERECO)
VALUES (2, 'Avenida Paulista', 'Passeio de Rua', 2);
INSERT INTO TB_PONTO_TURISTICO (CD_PONTO_TURISTICO, DS_PONTO_TURISTICO, DS_TIPO, CD_ENDERECO)
VALUES (3, 'Bairro da Liberdade', 'Passeio de Rua', 3);

## exemplo sintaxe de correção por update
UPDATE TB_MUNICIPIO
   SET DS_MUNICIPIO = 'Santo André'
 WHERE CD_MUNICIPIO = 4;

## estrutura comando delete
DELETE FROM nome_tabela
 WHERE condição;

## exemplo de comando para excluir um reistro
DELETE FROM TB_MUNICIPIO
 WHERE CD_MUNICIPIO = 5

## estrutura comando select
SELECT *
  FROM nome_tabela
 WHERE condição ORDER BY nome_coluna;

## exemplo de consulta da tabela inteira 
SELECT *
  FROM TB_ENDERECO;

## exemplo de consulta de campos da tabela 
SELECT DS_LOGRADOURO, NU_COMPLEMENTO
  FROM TB_ENDERECO;

## order by para ordernar em ordem alfabética
SELECT DS_LOGRADOURO, NU_COMPLEMENTO
  FROM TB_ENDERECO
 ORDER BY DS_LOGRADOURO;

## filtrando registros da tabela 
SELECT DS_LOGRADOURO, NU_COMPLEMENTO
  FROM TB_ENDERECO
 WHERE CD_BAIRRO = 2

## join
SELECT *
  FROM TB_ENDERECO E
  JOIN TB_BAIRRO B
    ON E.CD_BAIRRO = B.CD_BAIRRO
  JOIN TB_TIPO_LOGRADOURO T
    ON E.CD_TIPO_LOGRADOURO = T.CD_TIPO;

## Right join 
SELECT *
  FROM TB_ENDERECO E
 RIGHT JOIN TB_BAIRRO B
    ON E.CD_BAIRRO = B.CD_BAIRRO;

## left join 
SELECT *
  FROM TB_MUNICIPIO M
 LEFT JOIN TB_BAIRRO B
    ON B.CD_MUNICIPIO = M.CD_MUNICIPIO;

## count
SELECT
    COUNT(CD_PONTO_TURISTICO) AS QDE
  FROM TB_PONTO_TURISTICO;

## avg
SELECT
    AVG(NU_COMPLEMENTO) AS MEDIA_NUMERACAO
  FROM TB_ENDERECO;

## round avg
SELECT
    ROUND(
        AVG(NU_COMPLEMENTO)
    ) AS MEDIA_NUMERACAO
  FROM TB_ENDERECO;

## max
SELECT
    MAX(NU_COMPLEMENTO) AS MAXIMO_NUMERACAO
  FROM TB_ENDERECO;

## min 
SELECT
    MIN(NU_COMPLEMENTO) AS MINIMO_NUMERACAO
  FROM TB_ENDERECO;

## sum 
SELECT
    SUM(NU_COMPLEMENTO) AS SOMA_NUMERACAO
  FROM TB_ENDERECO;

## group by
SELECT
    DS_MUNICIPIO,
    COUNT(CD_BAIRRO) AS QDE_BAIRRO
  FROM TB_BAIRRO
 RIGHT JOIN TB_MUNICIPIO
    ON TB_BAIRRO.CD_MUNICIPIO = TB_MUNICIPIO.CD_MUNICIPIO
 GROUP BY DS_MUNICIPIO;

## having 
SELECT
    TB_TIPO_LOGRADOURO.DS_TIPO,
    COUNT(CD_PONTO_TURISTICO) QDE_PONTO_TURISTICO
  FROM TB_PONTO_TURISTICO
 RIGHT JOIN TB_ENDERECO
    ON TB_PONTO_TURISTICO.CD_ENDERECO = TB_ENDERECO.CD_ENDERECO
 RIGHT JOIN TB_TIPO_LOGRADOURO
    ON TB_ENDERECO.CD_TIPO_LOGRADOURO = TB_TIPO_LOGRADOURO.CD_TIPO
 GROUP BY TB_TIPO_LOGRADOURO.DS_TIPO
 HAVING COUNT(CD_PONTO_TURISTICO) > 1;